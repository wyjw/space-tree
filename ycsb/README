Mostly from https://github.com/utsaslab/RECIPE
